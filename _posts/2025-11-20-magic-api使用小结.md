---
layout:     post
title:      magic-api使用小结
subtitle:
date:       2025-11-20
author:     RC
header-img:
catalog: true
tags:
    - Java
    - API开发
    - 低代码
    - 轻量级框架
---


### 背景

> magic-api是一个基于Java的接口快速开发框架，编写接口将通过magic-api提供的UI界面完成，自动映射为HTTP接口。 无需定义Controller、Service、Dao、Mapper、XML、VO等Java对象即可完成常见的HTTP API接口开发。

公司最近的项目因为快速部署等要求使用了magic-api作为接口开发的框架，本文从基本功能开始，将实际遇到的各种场景需要的代码块和踩坑经验进行展示，仅作记录参考。

### 各种例子

#### 配置连接会话参数

magic-api本身已经支持MySQL、MariaDB、Oracle、DB2、PostgreSQL、SQLServer等支持jdbc规范的数据库，在信创大背景中（xugu、oceanbase），也可以在数据源的URL中直接加上会话参数更好的进行开发工作。

```
jdbc:mysql://xxxx:xxxx/your_schema?sessionVariables=group_concat_max_len=1000000

jdbc:xugu://xxxx:xxxx/your_schema?compatiblemode=MySQL&useSSL=false&current_schema=your_schema
```

> 对应的驱动需要在magic-api驱动包中添加，比如com.xugu.cloudjdbc.Driver

#### MyBatis的动态SQL语法

最常用的if标签，当满足条件时，会拼进SQL语句中，适合大部分入参场景。

```
<if test="reimbursementAmount != null and reimbursementAmount != ''">                                   and total\_amount>=#{reimbursementAmount}                             
</if>
```

多选一的排他逻辑choose，只会执行第一个满足条件的分支，否则执行otherwise（可选），类似switch-case。

```
<choose>
        <when test="phone != null and phone != ''">
            AND phone = #{phone}
        </when>
        <when test="idCard != null and idCard != ''">
            AND id_card = #{idCard}
        </when>
        <otherwise>
            AND status = 1
        </otherwise>
    </choose>
```

### 参考
