---
layout:     post
title:      数据分析平台小结
subtitle:
date:       2023-11-14
author:     RC
header-img:
catalog: true
tags:
    - 数据仓库
    - FlinkCDC
    - 数据分析
    - 大数据
    - 流计算
---


### 项目背景

本文是针对成都市“蓉易办”数据分析管理系统（以下简称数据分析平台）中技术架构、数据仓库建设和数据分析工作的内容的小结。

数据分析平台的主要数据来源为“天府蓉易办”平台和省一体化平台的政务数据。

“天府蓉易办”平台是成都按照国家和四川省关于一体化在线政务服务平台的相关要求，在吸收借鉴先进城市优秀经验基础上，打造的智能化政务服务一网通办平台，让企业和群众办事 “上一张网，最多跑一次、 一次能办成” 。同时，也是成都市优化营商环境的重要品牌。

> 本文编写时间为2023年11月，蓉易办1期项目已于2023年10月验收完毕

数据分析平台建设目的主要有：

- 解决数据实时同步问题，将业务数据及时同步给数据分析管理平台使用
	 
- 建立蓉易办数据仓库，实现数据来源、数据治理、数据共享统一管理
	 
- 实现办件、排对叫号、好差评、事项、行政区划和部门等业务、指标数据实时同步，实时计算和离线计算
	 
本人根据公司安排参与了数据分析平台自2023年1月至今的数仓建设、数据分析、数据共享、故障处理等工作，因工作中首次涉及到了Flink CDC、TiDB等组件的使用，遇到了一些问题并采取了解决办法，所以编写了本文做一个阶段性的技术总结。

### 数据分析平台技术架构

数据分析平台整体的技术架构如下：

![1](https://i.postimg.cc/kXxWHx4M/image.jpg)

可以看到比较的轻型且容易理解，总的流程为：

业务系统、省一体化平台等数据源将数据同步到TDSQL形成的前置库， 数据分析平台通过Flink CDC实时捕获数据变化，经过实时计算同步、加工数据到数据仓库各层（ODS, DWD, DIM, ADS层）。实时计算处理实时业务需求，离线计算处理非实时业务需求（如业务统计指标计算），最终提供数据到蓉易办数据管理分析平台用于统计分析、支撑大屏数据展示、支持其他平台的数据共享交换等。

> 因TDSQL本身是一个分布式的类MySQL数据库，因此提供了binlog，这使得Flink CDC不需要任何额外的组件就可以通过binlog捕获所有数据的状态变化和更新，达到流计算的要求。

> 但同时，我们应该清楚的认识到，作为实时计算的代价，基于Flink CDC的流计算任务根据计算的复杂度和表的大小所耗费的内存可能极大

### Flink CDC简介

