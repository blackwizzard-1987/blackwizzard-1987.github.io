---
layout:     post
title:      知识图谱绘制和ETL过程整理(上)
subtitle:
date:       2023-03-01
author:     RC
header-img:
catalog: true
tags:
    - 知识图谱
    - ER图
    - neo4j
    - 大数据
    - 政务服务
---

### 背景

“天府蓉易办”是属于成都市政务服务管理和网络理政办公室牵头下的品牌，是成都市以省一体化平台作为基础支撑，利用成都市大数据中心汇聚的数据资源，建设集“一网受理、协同办理、综合管理”于一体的在线政务服务品牌。

其中的“一件事服务”涵盖了多个个人和法人一件事服务，比如企业开办一件事、新生儿出生一件事等，涵盖户籍办理、社会保障、设立变更、就业创业等18个主题分类，通过联办事项和四川政务服务网对接，达到一次告知、一表申请、一口受理、一网审批、一窗发证、一体管理，实现数据多跑路，人少跑路的宗旨。

![1](https://i.postimg.cc/sx1HdMq7/1.png)

蓉易办的数据分析管理平台的事项库拥有绝大部分关于流程改造平台中一件事等相关的数据，根据公司领导的战略性要求，我们根据这部分数据从数据探查开始，按照上海市普陀区“政务服务一图通”的思路，以ER图为原型，通过Neo4j为载体，成功制作了一件事相关数据的知识图谱。

本文主要介绍项目初期的数据探查梳理工作和ER原型图的绘制。

### 数据探查和梳理工作

包括对流程改造平台事项库的所有库表的数据探查，找到它们的**数据关联关系**，为ER图绘制和平台人员对接业务流程做准备，主要工作：

- 53张表的表结构、字段字典、表注释、表行数、唯一标识梳理

- 对所有表的数据内容进行标注

- 对所有关联表的数据关联关系，关联字段梳理

该阶段是整个图谱的数据基座，需要尽可能的对库中的每张表都进行细致的梳理，梳理过程中也发现了很多问题：

- 省一体化改造平台的数据推送规则是保留所有历史版本，每次带上推送时间、批次号、删除标识和版本号，并同步/异步更新相关联的表中的数据，例如：

![2](https://i.postimg.cc/7Zbz3g7g/2.png)

```html
处理规则：
1.根据唯一标识分组按照cd_time倒序排序取最新一条数据使用
2.最新版本的记录标记为U(删除)的数据不处理，过滤掉
3.对于1规则下使用的数据在后续标签的建立时，带入三个属性（CdTime、CdBatch、CdOperation）表示数据推送情况
```

> 以上处理规则都基于流程改造平台本身会同步更新所有关联的表的数据，如果只更新部分表的数据，会导致头部表最新的数据无法和后续的关联表匹配联动

- 部分表的数据之间关联不明显，或者有重复的部分，比如主题表和一件事主题表中共有75个相同名字的主题，而这两张表对应的表的数据完全不同

```html
处理规则：
1.先将这些表作为独立部分分别和其对应的表关联处理，后续通过平台人员对接并确定业务流程和规则
```

- 部分表的数据可能存在两套逻辑，一套对应后台数据互相关联，一套对应业务逻辑用于使用，光从数据上无法理解或者理解起来有歧义，比如：

```html
处理规则：
1.将问题数据整理汇总，等待与平台人员对接后确定业务流程和规则
```

```html
为(后续沟通)整理后结果：
原始材料是标准材料的集合称呼，是一级材料
标准材料是原始材料的分解细化，是二级材料
二级材料的表格/表单/模板就是材料附件
一级材料对应事项，一级材料包含了二级材料，二级材料对应了办件

但实际上表中的数据一级和二级材料名字一致
```

- 同上，一些表的数据仅通过数据字典、数据聚合分类难以理解含义，需要结合业务的实际使用情况去理解，比如：

```html
处理规则：
1.将问题数据整理汇总，等待与平台人员对接后确定业务流程和规则
```

```html
主项、子项和办理项之间的关系？
为(后续沟通)整理后结果：
主项、子项等于办理项(存在没有子项的办理项=主项)
子项会有多个等于办理项，此时主项只是一个代号

一件事情形和精细化事项情形？
为(后续沟通)整理后结果：
先筛选办哪个不办哪个事项（N个里面选）（根据业务场景->主题的业态情形）
->再关联单个精细化事项的情形，满足哪个条件不满足哪个
->得到对应情形下的材料，进行提交
->最终获得办成一件事的所有材料

蓉易办的跳转、分发及深度对接？
为(后续沟通)整理后结果：
1.直接在蓉易办  
2.通过跳转（分发） --不存在业务数据
3.综合窗口统一受理（深度对接），推送部门 -- 存业务数据
```

> 由于平台人员只能口述回答问题，我们根据现场的回答提炼了主要内容，比较口语化，但不影响问题的定义和业务的规则、流程整理

### 小结

### 参考

[普陀区政务服务“一图通”](https://mp.weixin.qq.com/s/hFk66HvUKKZCG-H8eI-SkA)

